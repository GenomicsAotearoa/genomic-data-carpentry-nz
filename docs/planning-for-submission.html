<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>planning-for-submission ‚Äì Genomic Data Carpentry (Aotearoa edition)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data-storage-and-management.html" rel="next">
<link href="./organisation-tidiness.html" rel="prev">
<link href="./theme-images/GA-image-black-favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-709f788519238433456b39eacb8aeed0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="‚Äì Genomic Data Carpentry (Aotearoa edition)">
<meta property="og:description" content="">
<meta property="og:image" content="figures/illumina-libprep-01.png">
<meta property="og:site_name" content="Genomic Data Carpentry (Aotearoa edition)">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./planning-for-submission.html">Planning for submission</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Data Carpentry (Aotearoa edition)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/GenomicsAotearoa/reproducibility_with_git_and_quarto" title="Github" class="quarto-navigation-tool px-1" aria-label="Github"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test-styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">_test styles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./outtakes-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">_outtakes/notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation-tidiness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organisation and tidy data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./planning-for-submission.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Planning for submission</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-storage-and-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genomic data storage and management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-wrangling-and-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genomic data wrangling and processing</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#planning-for-submission" id="toc-planning-for-submission" class="nav-link active" data-scroll-target="#planning-for-submission">Planning for submission</a>
  <ul>
  <li><a href="#quality-control-of-dnarna" id="toc-quality-control-of-dnarna" class="nav-link" data-scroll-target="#quality-control-of-dnarna">Quality control of DNA/RNA</a></li>
  <li><a href="#sequencing-libraries" id="toc-sequencing-libraries" class="nav-link" data-scroll-target="#sequencing-libraries">Sequencing libraries</a>
  <ul class="collapse">
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">DISCUSSION üí¨</a></li>
  </ul></li>
  <li><a href="#flow-cells-and-sequencing-platforms-101" id="toc-flow-cells-and-sequencing-platforms-101" class="nav-link" data-scroll-target="#flow-cells-and-sequencing-platforms-101">Flow cells and sequencing platforms 101</a></li>
  <li><a href="#decision-points" id="toc-decision-points" class="nav-link" data-scroll-target="#decision-points">Decision points ü§î</a></li>
  <li><a href="#nz-sequencing-facilities-and-services" id="toc-nz-sequencing-facilities-and-services" class="nav-link" data-scroll-target="#nz-sequencing-facilities-and-services">NZ sequencing facilities and services</a>
  <ul class="collapse">
  <li><a href="#working-with-nz-seq-facilities" id="toc-working-with-nz-seq-facilities" class="nav-link" data-scroll-target="#working-with-nz-seq-facilities">working with NZ seq facilities</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>
<div class="workshop-banner">
  WORK IN PROGRESS
</div>




<section id="planning-for-submission" class="level1">
<h1>Planning for submission</h1>
<p>You‚Äôve done your experiment, extracted some DNA or RNA, and want to sequence it, but now what?</p>
<section id="quality-control-of-dnarna" class="level2">
<h2 class="anchored" data-anchor-id="quality-control-of-dnarna">Quality control of DNA/RNA</h2>
<p>Your DNA or RNA samples will need to pass certain quality cut-offs for sequencing, which the sequencing facility will ask for and will have thresholds they require upon submission (e.g., see the <a href="https://www.otago.ac.nz/genomics/project-sample-info/requirements">Otago Genomics Facility requirements here</a>). After you have done your extractions in the lab, you should perform QC with:</p>
<ol type="1">
<li><p>A spectrophotometer (e.g., NanoDrop, DeNovix), which will give you a good indication of the purity/contamination of your sample through 260/280 and 260/230 ratios. This method is not very reliable for determining concentration of your nucleic acid.</p></li>
<li><p>A fluorescent-based quantification method (e.g., Qubit), which will give you a very accurate indication of concentration of your nucleic acid (but not of any contaminants).</p></li>
<li><p>A fragment analysis instrument (e.g., Agilent 2100 Bioanalyzer, Agilent 5300 Fragment Analyzer or Agilent TapeStation), which you can think of like a high-tech agarose gel. It will give you a good indication of your 28S/18S ratio for RNA (this is used to determine the overall RIN - RNA integrity number) or your fragment size distribution for DNA.</p></li>
</ol>
<p>Together, these will give you an almost complete picture of your sample, ready for sequencing. Note that if your samples are below threshold quality, there are protocols that can allow for lower quality or degraded samples. Ideally, this should only be done if there is no option to re-extract, re-purify or repeat the experiment.</p>
</section>
<section id="sequencing-libraries" class="level2">
<h2 class="anchored" data-anchor-id="sequencing-libraries">Sequencing libraries</h2>
<p>The first thing that needs to be done for Illumina, PacBio or Oxford Nanopore (ONT) sequencing is to turn the DNA or RNA sample into something called a <em>library</em>. This converts the raw nucleic acids into a form that the sequencer can actually read. This is generally done by the technician that will also sequence your samples, but some labs may do library prep in-house (i.e., <em>you</em> may do it yourself!). Nanopore is a little different, in that it can sequence native RNA directly, with minimal prep before sequencing. DNA library preparation for ONT sequencing is also generally simpler than for Illumina and PacBio. This is because the technology used to sequence the DNA/RNA using ONT is quite different to how Illumina and PacBio achieve it‚Äìmore on that in the next section on <a href="#flow-cells-and-sequencing-platforms-101">flow cells and sequencing platforms 101</a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Illumina lib prep molecular workflow diagram
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="figures/illumina-libprep-01.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>Library preparation (for Illumina and PacBio) generally involves the following steps, and takes 1-2 days in the lab:</p>
<ol type="1">
<li><p><strong>(Optional) Target enrichment / RNA selection</strong><br>
Selectively enriching for your target molecule (e.g., for standard RNAseq you likely will do polyA capture).<br>
</p></li>
<li><p><strong>(RNAseq only)</strong> Converting your RNA into cDNA using reverse transcriptase.<br>
</p></li>
<li><p><strong>Fragmentation (if needed</strong>) Some kits fragment RNA before reverse transcription, others fragment cDNA/DNA after.<br>
This ensures fragments are the right size for the platform (e.g., ~200‚Äì400 bp for Illumina).</p></li>
<li><p><strong>End repair and A-tailing</strong><br>
Ends are cleaned up so adapters can be ligated efficiently.</p></li>
<li><p><strong>Adapter ligation</strong><br>
Adapters are short sequences that enable library binding to the flow cell (Illumina) or capture for SMRTbells (PacBio).<br>
Some kits combine this with indexing.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PacBio lib prep - SMRTbell adapters
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="figures/pacbio-libprep-01.png" class="img-fluid"></p>
<p>Note: the SMRTbell technology allows HiFi (high fidelity) long read sequencing. The DNA becomes circularised, which allows the polymerase to make repeated passes around the DNA and the consensus sequence therefore has a higher accuracy than single pass sequencing.</p>
</div>
</div>
</div>
<ol start="6" type="1">
<li><p><strong>Indexing (barcoding)</strong><br>
Indices allow multiple samples to be pooled together and sequenced on the same flow cell, then computationally separated afterward (called mulitplexing and demultiplexing).</p></li>
<li><p><strong>Size selection / cleanup</strong><br>
Typically done with magnetic beads to remove adapter dimers and select the desired fragment range.</p></li>
<li><p><strong>Library amplification (if required)</strong><br>
Some protocols use PCR to enrich adapter-ligated molecules; others (e.g., some PacBio) are PCR-free.</p></li>
<li><p><strong>Final QC and quantification</strong><br>
Using Qubit, Bioanalyzer/Tapestation/Fragment Analyzer, etc. This step ensures your library meets sequencing requirements.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bioanalyzer trace of final library (Illumina mRNA lib prep)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="figures/illumina-libprep-02.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>There are different library prep methods (i.e., protocols) for each platform that you will also need to chose. This will depend on a few things, such as:</p>
<ul>
<li>The quality of your RNA/DNA (e.g., high-quality RNA allows polyA selection; degraded samples may require ribo-depletion or specialised kits).<br>
</li>
<li>The species/tissue type you extracted your RNA/DNA from (e.g., plants have rRNA types that require plant-specific depletion kits, some tissues have high mitochondrial RNA content).<br>
</li>
<li>The type of analysis you want to do i.e., what is your research question</li>
</ul>
<p>For example, if you are doing a ‚Äòstandard‚Äô Illumina RNA sequencing project (e.g,. you plan to do differential gene expression analysis to compare different samples), a common choice is <strong>Illumina stranded mRNA library prep</strong>, which uses polyA selection to capture mRNA. However, you may chose <strong>Illumina total RNA library prep</strong> with ribo-depletion, which is more expensive, but it has some advantages such as: it can capture non-polyadenylated RNAs (more comprehensive RNA profile) and and is a better option if your samples are partially degraded (it can also handle FFPE samples).</p>
<section id="discussion" class="level4">
<h4 class="anchored" data-anchor-id="discussion">DISCUSSION üí¨</h4>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why do you think polyA capture is used for ‚Äòstandard‚Äô RNAseq?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Mature mRNAs have polyA tails, which can be selectively isolated using oligo DT coated beads that bind mature RNAs only. All other non-polyadenylated nucleic acids and cellular debris can then be washed away.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why do you think we bother adding ‚Äúindex‚Äù sequences to libraries at all? Why not sequence each sample separately?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Indexing (barcoding) allows multiple samples to be pooled in a single sequencing run. This massively reduces cost and time. Because each library carries a unique index, the sequencer can mix them together, and downstream software can computationally separate (demultiplex) them accurately afterward.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why do you think size selection is such an important step? What would happen if we skipped it?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Size selection ensures that fragments fall within the size range the sequencer expects. Without it, you may get:</p>
<ul>
<li><p>adapter dimers (which waste sequencing reads as they take up ‚Äòreal estate‚Äô on the flow cell)</p></li>
<li><p>too-short fragments (which cluster preferentially, causing over-representation and distorts the data e.g., sequencing may read into adapters or flow cell)<br>
</p></li>
<li><p>too-long fragments (which may not fully sequence or reduce yield)</p></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="flow-cells-and-sequencing-platforms-101" class="level2">
<h2 class="anchored" data-anchor-id="flow-cells-and-sequencing-platforms-101">Flow cells and sequencing platforms 101</h2>
<p>The three major sequencing platform and consumables companies are Illumina, PacBio (Pacific Biosystems) and Oxford Nanopore Technologies (ONT). Each make different platforms/instruments that can handle different levels of throughput, but the chemistry and the ‚Äòreading‚Äô of the sequencing is the main point of difference between the three companies.</p>
<p>A few examples of the different platforms are:</p>
<p><strong>Illumina</strong></p>
<ul>
<li>MiSeq<br>
</li>
<li>NextSeq<br>
</li>
<li>NovaSeq</li>
</ul>
<p><strong>PacBio</strong></p>
<ul>
<li>Sequel II<br>
</li>
<li>Revio</li>
</ul>
<p><strong>Oxford Nanopore Technologies</strong></p>
<ul>
<li>MinION<br>
</li>
<li>GridION<br>
</li>
<li>PromethION</li>
</ul>
<p>A <strong>flow cell</strong> is the physical surface inside the sequencing machine (or platform) where the actual reading of DNA or RNA occurs. There are different sizes you can chose from, depending on how many reads you need. Although Illumina, PacBio, and ONT all call their consumables ‚Äúflow cells,‚Äù the underlying technologies are very different.</p>
<p>For the most part, and in-depth knowledge of how these flow cells work is not needed to get you started with your sequencing project.</p>
<p>Here are the basic differences:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 23%">
<col style="width: 31%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Illumina</th>
<th>PacBio (HiFi / SMRT)</th>
<th>Oxford Nanopore (ONT)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>How sequencing works</strong></td>
<td>Sequencing-by-synthesis (fluorescent nucleotides added one base at a time)</td>
<td>Single-molecule real-time sequencing (polymerase incorporates fluorescent bases inside ZMWs)</td>
<td>Nanopore sensing (changes in ionic current as DNA/RNA passes through a pore)</td>
</tr>
<tr class="even">
<td><strong>Flow cell structure</strong></td>
<td>Patterned flow cell with billions of oligos that form clonal clusters</td>
<td>SMRT Cell containing millions of Zero-Mode Waveguides (ZMWs)</td>
<td>Membrane embedded with thousands of protein nanopores</td>
</tr>
<tr class="odd">
<td><strong>What binds to the flow cell</strong></td>
<td>Libraries bind via adapters to oligos ‚Üí amplified into clusters</td>
<td>A single SMRTbell + polymerase complex loads into each ZMW</td>
<td>DNA or RNA strand with a motor protein threads into a nanopore</td>
</tr>
<tr class="even">
<td><strong>Signal detected</strong></td>
<td>Fluorescent signal imaged each cycle</td>
<td>Fluorescent flashes when each base is incorporated</td>
<td>Changes in electrical current across the pore</td>
</tr>
<tr class="odd">
<td><strong>Amplification?</strong></td>
<td>Yes ‚Äî cluster generation required</td>
<td>No ‚Äî true single-molecule reads</td>
<td>No (PCR-free), though can use PCR in library prep</td>
</tr>
<tr class="even">
<td><strong>Typical read length</strong></td>
<td>100‚Äì300 bp</td>
<td>10‚Äì25 kb HiFi reads</td>
<td>10 kb to &gt;100 kb (ultra-long &gt;1 Mb possible)</td>
</tr>
<tr class="odd">
<td><strong>Can sequence native RNA?</strong></td>
<td>No ‚Äî convert to cDNA library</td>
<td>No ‚Äî convert to cDNA library</td>
<td>Yes ‚Äî direct RNA sequencing</td>
</tr>
<tr class="even">
<td><strong>Strengths</strong></td>
<td>High accuracy, high throughput, cost-efficient, chemistry highly compatible with different species/tissues</td>
<td>Highly accurate long reads; excellent for haplotype resolution</td>
<td>Ultra-long reads; portable; real-time analysis; can detect base mods</td>
</tr>
<tr class="odd">
<td><strong>Limitations</strong></td>
<td>Short reads only</td>
<td>Lower throughput than Illumina; expensive</td>
<td>Higher raw error rate; pore lifetime limits yield and susceptible to clogging</td>
</tr>
<tr class="even">
<td><strong>Best used for</strong></td>
<td>Standard RNA-seq (DGE); de novo transcriptomes; high-depth short-read assays; metagenomics; error-correcting long reads</td>
<td>Genome assembly (chromosome-level with HiFi); full-length RNA (Iso-Seq for isoforms); structural variant detection</td>
<td>Field-based sequencing (e.g, rapid microbial identification); genome assembly; native RNA including modification detection (e.g., methylation)</td>
</tr>
</tbody>
</table>
</section>
<section id="decision-points" class="level2">
<h2 class="anchored" data-anchor-id="decision-points">Decision points ü§î</h2>
<p>Choosing a platform to do your sequencing comes down to the question you are trying to answer. See the last row in the table above ‚ÄòBest use for‚Äô for some examples of why you might pick one platform over another!</p>
<p>When you get in contact with a sequencing facility, the question they will ask you is not <em>how many samples are you sequencing</em>, but rather, <em>how many reads do you need?</em> This will determine what size flow cell you need, and to some extent, which platform you will use, as different platforms have different capacity (e.g,. Illumina NextSeq is a ‚Äòmedium throughput‚Äô platform, NovaSeq is a ‚Äòlarge throughput‚Äô platform). The number of reads you need scale with the size of the genome and/or complexity of your transcriptome.</p>
<p><strong><em>As a general rule of thumb,</em></strong> for <strong><em>transcriptome sequencing</em></strong> you will need:</p>
<p><strong>Table 1:</strong> Reads per sample</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Purpose / Type</th>
<th>Approx reads per sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Gene expression profiling</td>
<td>5‚Äì25 million</td>
</tr>
<tr class="even">
<td>Complete expression + alternative splicing</td>
<td>30‚Äì60+ million</td>
</tr>
<tr class="odd">
<td><em>De novo</em> transcriptome assembly</td>
<td>~100+ million</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<p>The next thing the sequencing facility will ask you if you are doing short-read sequencing (Illumina) is do you want <em>single-end</em> or <em>paired-end</em> reads. This refers to whether you want a single read (read 1), sequenced from only one end of the library molecule (fragment), or if you want two reads per library molecule (read 1 and read 2, antisense and sense strands). Paired-end costs more, but gives you more resolution.</p>
<p>There are <strong><em>pros</em></strong> and <strong><em>cons</em></strong> to choosing either chemistry:</p>
<p><strong>Table 2:</strong> Single-end vs paired-end chemistry (short-read Illumina sequencing)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 39%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>Chemistry</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Single-end (SE)</strong></td>
<td>Lower cost, fewer reads required (may be able to do more samples); sufficient for basic gene-level DGE</td>
<td>Limited splice/isoform resolution; less confident mapping when mapping to a genome</td>
</tr>
<tr class="even">
<td><strong>Paired-end (PE)</strong></td>
<td>Better alignment; improved splice junction and isoform detection; more robust for complex transcriptomes or <em>de novo</em> transcriptome assembly</td>
<td>Higher cost; ~2√ó sequencing required (two reads per fragment)</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<p>Lastly, if you are doing short-read sequencing (i.e., Illumina), the sequencing facility will ask you <em>what read length you want</em>. You can typically chose from between 50bp-300bp (platform-dependent). The choice between a lower or higher read length will be a balance of cost (higher read length = higher cost) and the level of information you need (complex, novel or <em>de novo</em> transcriptomes require higher read lengths; more straight forward analyses with well-annotated genomes can utilise lower read lengths). In contrast, for long-read sequencing platforms (ONT and PacBio), you do not specify a fixed read length. Instead, reads are generated as single, continuous sequences, and their length is determined by the size of the input molecules, the library preparation method, and the sequencing chemistry.</p>
<p>Choosing a <strong><em>read length</em></strong> is a <strong><em>trade-off between cost, and the amount of information</em></strong> you will recover:</p>
<p><strong>Table 3:</strong> Read length (short-read Illumina sequencing)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Read length</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>50 bp</strong></td>
<td>Lowest cost; highest sample multiplexing; sufficient for basic gene-level DGE in well-annotated genomes</td>
<td>Poor isoform and splice junction resolution; higher multi-mapping</td>
</tr>
<tr class="even">
<td><strong>100 bp</strong></td>
<td>Good balance of cost and information; reliable splice junction detection; widely used for standard RNA-seq</td>
<td>Slightly lower throughput than 50 bp; may miss very complex isoforms</td>
</tr>
<tr class="odd">
<td><strong>150 bp</strong></td>
<td>Improved isoform resolution; better mapping across repetitive regions; useful for novel transcript discovery</td>
<td>Higher cost; fewer reads per run</td>
</tr>
<tr class="even">
<td><strong>300 bp</strong></td>
<td>Maximum per-read information; helpful for <em>de novo</em> transcriptome assembly</td>
<td>Rarely necessary for Illumina RNA-seq; expensive; reduced throughput</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
EXERCISE #1 üß†üèãÔ∏è‚Äç‚ôÄÔ∏è (15 mins)
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><em>Example RNAseq scenario:</em></strong></p>
<p>You are working on a mouse model of cancer genomics. You want to do differential gene expression analysis to compare tumour samples to non-cancerous control tissue, to see if you can find genes that are up or down regulated in the cancerous tissue. You have 40 RNA samples, and since your species has a high-quality reference genome and annotation (i.e., mouse: Mus musculus), you know you have a ‚Äúgood‚Äù genome assembly and annotations to map your sequencing data back to (more on ‚Äúgood‚Äù genomes later!). The mouse genome is ~2.7 Gb (= 2,700,000,000 bp), diploid, with ~20,000 protein-coding genes.</p>
<p>You are particularly interested in alternative splicing and novel splice junctions, as you suspect that cancer-associated genes are often regulated at the isoform level.</p>
<p>You will sequence your samples at the Otago Genomics Facility, and see on <a href="https://www.otago.ac.nz/genomics">their website</a> they have an Illumina MiSeq and an Illumina NextSeq 2000.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which platform will you chose?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The Illumina NextSeq 2000 is a ‚Äòmedium‚Äô sized short read sequencing platform, ideal for standard RNAseq, and is well-suited to this project. It can output up to 540Gb.</p>
<p>The Illumina MiSeq is a ‚Äòsmall‚Äô sized short read sequencing platform, better suited to QC or amplicon sequencing, and can output up to 30Gb. It is too small for this project.</p>
<p><a href="https://sapac.illumina.com/systems/sequencing-platforms.html">Illumina benchtop sequencing platforms comparison</a></p>
</div>
</div>
</div>
<p>Next you need to decide how many reads you need.</p>
<p>Based on table 1 above, how many reads do you need per sample?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reads per sample choice:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You decide you need 30 million reads per sample. You pick the lower end of the scale, as you suspect the genes you are most interested in will be highly expressed, and don‚Äôt expect your tissue to have a particular high transcript diversity that would require more reads.</p>
<p>You work out what minimum output you need from the flow cell:<br>
30 mil reads * 40 samples = 1200 million reads (1.2B).</p>
</div>
</div>
</div>
<p>Now you need to decide if you want paired-end or single end reads.</p>
<p>Based on table 2 above, what would you pick?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Paired-end vs single end choice:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Paired-end sequencing will give better detection of novel isoforms and splice junctions.</p>
<p>This doubles the number of reads generated per fragment and will give you better resolution.</p>
</div>
</div>
</div>
<p>You now need to decide which read length you need. Given the mouse genome is well-annotated, but you are looking for potentially novel isoforms, which read length would you pick, based on table 3?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Read length choice:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>50 bp would be a good choice for a well-annotated genome like mouse for standard RNAseq, but does not suit this experiment, as you are looking for novel isoforms/alternative splicing.</p>
<p>100bp is probably the best choice, balancing cost with novel isoform discovery.</p>
<p>You could also chose 150bp, if you want to be sure you‚Äôd capture novel isoforms, especially if they are quite long or complex genes - and don‚Äôt mind a higher cost.</p>
</div>
</div>
</div>
<p>You are now ready to pick your flow cell. Check out the <a href="https://sapac.illumina.com/systems/sequencing-platforms/nextseq-1000-2000/specifications.html">Illumina NextSeq2000 flow cell specifications</a> and chose which flow cell will suit this project best. There are four flow cells in ascending output size you can choose from: P1, P2, P3 and P4.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which flow cell will you pick?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Based on paired end sequencing using 100bp read length (i.e., 2 x 100bp):</p>
<p>Total reads needed for your experiment: 1.2 billion reads.<br>
Calculation: 1.2 billion reads x 100 (bp) x 2 (PE) = 240 Gb (240 gigabase pairs, or 240 billion individual DNA bases sequenced).</p>
<ul>
<li>P1 ‚Üí No 100bp option and way too low<br>
</li>
<li>P2 ‚Üí 80 Gb (too low for 1.2B demand)<br>
</li>
<li>P3 ‚Üí 240 Gb (fits 1.2B reads requirement exactly - best choice!)<br>
</li>
<li>P4 ‚Üí 360 Gb (oversized for this project)</li>
</ul>
<p>Note: the maximum output stated for the flow cell is under optimal conditions, so the P3 flow cell choice just fits, but it is possible you will have less reads then anticipated (e.g., instead of 30 mil reads per sample, you may get 28 mil per sample).</p>
</div>
</div>
</div>
<p>Congratulations! You are now ready to sequence your RNAseq samples.</p>
</div>
</div>
<p>&nbsp;</p>
<p>Now let‚Äôs look at <strong>DNA sequencing</strong> in more detail.</p>
<p>DNA sequencing may refer to whole genome, whole exome, or targeted sequencing approaches. <strong>FILL in a bit more here by someone who knows DNAseq better</strong></p>
<p>For <strong>Genome sequencing</strong> you will need:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 29%">
<col style="width: 22%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Genome size</th>
<th>Example species</th>
<th>Approx genome size</th>
<th>Approx reads per sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tiny</td>
<td>Virus</td>
<td>&lt;0.1 Mb</td>
<td>0.1‚Äì0.5 million</td>
</tr>
<tr class="even">
<td>Small</td>
<td>Bacteria</td>
<td>5 Mb</td>
<td>5‚Äì10 million</td>
</tr>
<tr class="odd">
<td>Medium</td>
<td>Yeast</td>
<td>12 Mb</td>
<td>10‚Äì20 million</td>
</tr>
<tr class="even">
<td>Large</td>
<td>Fruit fly (<em>D. melanogaster</em>)</td>
<td>175 Mb</td>
<td>50‚Äì100 million</td>
</tr>
<tr class="odd">
<td>Very Large</td>
<td>Human</td>
<td>3 Gb</td>
<td>600‚Äì1,200 million</td>
</tr>
<tr class="even">
<td>Huge</td>
<td>Wheat</td>
<td>16 Gb</td>
<td>6‚Äì12 billion</td>
</tr>
</tbody>
</table>
<p>Where Mb = megabase pairs (<em>i.e.,</em> 1 Mb = 1,000,000 bp)</p>
<p>Coverage. talking about average coverage - really repetitive regions can have very low covergae, other more easily resolved sections will have higher coverage.</p>
<p>heterozygosity homozygosity.</p>
<p>haplotypes etc.</p>
<p>Stick mostly to decision points - not a huge lecture/tutorial on genome/ DNA biology. Assume learners haev a genetics background - they just have not yet translated that knowledge into a practical application of NGS.</p>
<p><br>
</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
EXERCISE #2 üß†üèãÔ∏è‚Äç‚ôÄÔ∏è (10 mins)
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><em>Example DNAseq scenario:</em></strong></p>
<p>You are want to <em>de novo</em> assemble the genome of the New Zealand swamp maire (<em>Syzygium maire</em>), a critically-endangered, endemic myrtaceae species, which is under threat from the pathogen myrtle rust.</p>
<p>Based on genome sizes of related Syzygium and Myrtaceae species (e.g., <em>Syzygium aromaticum</em> ~370 Mb, <em>S. grande</em> ~405 Mb), you expect the <em>S. maire</em> genome to be on the order of ~350‚Äì400 Mb.</p>
<p><em>De novo</em> genome assembly requires long read sequencing to resolve the longest contiguous sequences possible (ideally the full chromosome length, but that is often not easy or possible to achieve!).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Which long-read sequencing platform should you chose?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>There are two long-read platforms ‚Äì PacBio and ONT. <strong>PacBio better for throughput (amount of reads you can get back) and for accuracy than than ONT? Ask someone who knows this to fill in.</strong></p>
</div>
</div>
</div>
<p><a href="https://doi.org/10.1007/s11295-024-01659-5">Balkwill <em>et al.</em> 2024. Tree Genetics &amp; Genomes.</a></p>
<p>The authors also used Illumina sequencing in this paper. What did they use it for? Why do you think they chose to do Illumina sequencing for these samples rather than PacBio?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Answer: 30 x samples at low coverage for resequencing.<br>
Answer: cost, accuracy at SNP level. dont need to resolve full genomes as that was not their question.</p>
</div>
</div>
</div>
<p><br>
</p>
</div>
</div>
<blockquote class="blockquote">
<p>Note 1: Batch variation. Are you doing all your samples in one batch, or will you have multiple batches? Technical variation can occur, so you may want to wait and do all samples at once on one larger flow cell, or make sure you randomise samples across sequencing batches.</p>
</blockquote>
<blockquote class="blockquote">
<p>Note 2: DNAseq vs RNAseq. You may have noticed we call it ‚ÄòRNAseq‚Äô, even though we convert the RNA into DNA before sequencing! By convention, this is still called RNAseq, to differentiate it from true DNAseq.</p>
</blockquote>
</section>
<section id="nz-sequencing-facilities-and-services" class="level2">
<h2 class="anchored" data-anchor-id="nz-sequencing-facilities-and-services">NZ sequencing facilities and services</h2>
<blockquote class="blockquote">
<p>Current as of: December 2025</p>
</blockquote>
<p><strong>Sequencing facilities which offer NGS services:</strong></p>
<p><a href="https://www.otago.ac.nz/genomics">Otago Genomics Facility (OGF)</a><br>
Location: The University of Otago, Biochemistry Building.</p>
<ul>
<li>Illumina NextSeq 2000<br>
</li>
<li>Illumina MiSeq</li>
<li>ONT P2 Solo<br>
</li>
<li>ONT MinION</li>
<li>NanoString nCounter Analysis System (non-NGS)</li>
</ul>
<p>Performs: Moderate to large scale RNAseq, DNAseq, amplicon seq etc</p>
<p><a href="https://www.massey.ac.nz/about/clinics-and-services-for-the-public/massey-genome-service/">Massey Genome Service (MGS)</a><br>
Location: Massey University</p>
<ul>
<li>2 x Illumina MiSeq<br>
</li>
<li>Applied Biosystems 3500xl capillary instrumentation (non-NGS).</li>
</ul>
<p>Performs: small scale RNA or DNAseq, single gene (Sanger sequencing)</p>
<p><a href="https://www.genomics.auckland.ac.nz/">Auckland Genomics</a></p>
<ul>
<li>platforms: Illumina and ONT. They don‚Äôt list on their website which ones they have.</li>
</ul>
<p>Procotocol available - dont want to go into too much detail but becoems another decision point. Massey offer TruSeq lib prep. Auckland uses the newer kit. (slightly higher input required than the newer chemistry, both are very robust options. Newer one is supposed to be faster and better for more degarded RNA. Higher multiplexing for new kit 384 vs 96 for truseq).</p>
<p>See here for <a href="https://knowledge.illumina.com/library-preparation/rna-library-prep/library-preparation-rna-library-prep-faq-list/000005928">comparison between Illumina TruSeq stranded and Illumina stranded mRNA kits</a></p>
<p><strong><em>Non-service platforms around New Zealand:</em></strong></p>
<p><strong>AgResearch</strong><br>
- GenomNZ https://www.agresearch.co.nz/products-and-services/genomnz/ (Invermay) have a NovaSeq - they will do it if they have time and you ask nicely. They are a commercial animal DNA genotyping laboratory.</p>
<p><strong>Lincoln</strong><br>
- have MGI - compatible with Illumina libraries. not on website.</p>
<p>other</p>
<p><strong>Custom science</strong> (supplier, does not do the sequencing for you)</p>
<ul>
<li>New <a href="https://www.customscience.co.nz/kindstar-new-zealand">PacBio Revio in Auckland</a></li>
</ul>
<section id="working-with-nz-seq-facilities" class="level3">
<h3 class="anchored" data-anchor-id="working-with-nz-seq-facilities">working with NZ seq facilities</h3>
<p>stuff on submission process, show example form ?</p>
<p>how do you get data back from them ? how do they transfer it?</p>
<p>OGF gives you data back demultiplexed. I assume all other services in NZ do this too?</p>
<p>Do anyone use basespace to share reads with people?</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./organisation-tidiness.html" class="pagination-link" aria-label="Organisation and tidy data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Organisation and tidy data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./data-storage-and-management.html" class="pagination-link" aria-label="Genomic data storage and management">
        <span class="nav-page-text">Genomic data storage and management</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>