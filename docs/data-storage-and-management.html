<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>data-storage-and-management – Genomic Data Carpentry (Aotearoa edition)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data-wrangling-and-processing.html" rel="next">
<link href="./planning-for-submission.html" rel="prev">
<link href="./theme-images/GA-image-black-favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-709f788519238433456b39eacb8aeed0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="– Genomic Data Carpentry (Aotearoa edition)">
<meta property="og:description" content="">
<meta property="og:image" content="figures/reannz-01.png">
<meta property="og:site_name" content="Genomic Data Carpentry (Aotearoa edition)">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-storage-and-management.html">Genomic data storage and management</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Data Carpentry (Aotearoa edition)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/GenomicsAotearoa/genomic-data-carpentry-nz" title="Github" class="quarto-navigation-tool px-1" aria-label="Github"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test-styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">_test styles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./outtakes-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">_outtakes/notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation-tidiness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organisation and tidy data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./planning-for-submission.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Planning for submission</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-storage-and-management.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Genomic data storage and management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-wrangling-and-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genomic data wrangling and processing</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#genomic-data-storage-and-management" id="toc-genomic-data-storage-and-management" class="nav-link active" data-scroll-target="#genomic-data-storage-and-management">Genomic data storage and management</a>
  <ul>
  <li><a href="#genomic-data-files" id="toc-genomic-data-files" class="nav-link" data-scroll-target="#genomic-data-files">Genomic data files</a></li>
  <li><a href="#research-and-education-advanced-network-new-zealand-reannz" id="toc-research-and-education-advanced-network-new-zealand-reannz" class="nav-link" data-scroll-target="#research-and-education-advanced-network-new-zealand-reannz">Research and Education Advanced Network New Zealand (REANNZ)</a></li>
  <li><a href="#aoraki-at-the-university-of-otago" id="toc-aoraki-at-the-university-of-otago" class="nav-link" data-scroll-target="#aoraki-at-the-university-of-otago">Aoraki at the University of Otago</a></li>
  <li><a href="#other-universities-hpchcs-options" id="toc-other-universities-hpchcs-options" class="nav-link" data-scroll-target="#other-universities-hpchcs-options">Other universities HPC/HCS options?</a></li>
  <li><a href="#ethical-data-management" id="toc-ethical-data-management" class="nav-link" data-scroll-target="#ethical-data-management">Ethical data management</a>
  <ul class="collapse">
  <li><a href="#fair-and-care" id="toc-fair-and-care" class="nav-link" data-scroll-target="#fair-and-care">FAIR and CARE</a></li>
  <li><a href="#aotearoa-genomic-data-repository-agdr" id="toc-aotearoa-genomic-data-repository-agdr" class="nav-link" data-scroll-target="#aotearoa-genomic-data-repository-agdr">Aotearoa Genomic Data Repository (AGDR)</a></li>
  <li><a href="#rakeiora-genomics-platform" id="toc-rakeiora-genomics-platform" class="nav-link" data-scroll-target="#rakeiora-genomics-platform">Rakeiora Genomics platform</a></li>
  </ul></li>
  <li><a href="#public-data" id="toc-public-data" class="nav-link" data-scroll-target="#public-data">Public data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>
<div class="workshop-banner">
  WORK IN PROGRESS
</div>




<section id="genomic-data-storage-and-management" class="level1">
<h1>Genomic data storage and management</h1>
<p>Your samples have been sequenced, now what?</p>
<section id="genomic-data-files" class="level2">
<h2 class="anchored" data-anchor-id="genomic-data-files">Genomic data files</h2>
<p>Genomic data files are huge, and for one project you will often have several hundred gigabytes (GB) to sometimes terabytes (TB) of data (more on the actual genomic file types in the next section <a href="./data-wrangling-and-processing.html">Data wrangling and processing</a>). You most likely won’t be able to store and analyse these on your local computer, or transfer the files in the ‘traditional’ way using portable USB drives, so you’ll need to make use of a high capacity storage (HCS), high performance computing (HPC), and file transfer protocols (FTP). An introduction to genomics is also an introduction to the world of high performance computing!</p>
<p><em>Caveat: small genomes such as from bacteria often can be transferred, stored and analysed on your local computer.</em></p>
<p>You have a few options of how you want to store and analyse your data, which may be through HPC/HCS services offered by your University or Institute, or through the national computing and digital network REANNZ.</p>
</section>
<section id="research-and-education-advanced-network-new-zealand-reannz" class="level2">
<h2 class="anchored" data-anchor-id="research-and-education-advanced-network-new-zealand-reannz">Research and Education Advanced Network New Zealand (REANNZ)</h2>
<p>REANNZ is <em>“..a Crown-owned membership organisation that powers Aotearoa’s research and education network. Launched in 2007, their high-performance national digital network (or NREN) helps members collaborate and contribute to data-intensive and complex science and research initiatives – both here in New Zealand and across the globe.”</em></p>
<p>They offer many products and services – <a href="https://www.reannz.co.nz/">check out their website here</a> – but here we will focus on their <a href="https://www.reannz.co.nz/products-and-services/high-performance-computing-and-data-analytics">HPC platform</a> that you may chose to use to analyse your data.</p>
<p><strong><em>Projects on REANNZ</em></strong></p>
<p>To use the HPC services, you first need to make or be listed as a member on a ‘Project’. A ‘Project’ will have a code (e.g., nesi03181 or uoo00431) and will need to be linked to a funding source to charge back compute resources used. Multiple people can use one Project; this is often the preferable way to use a Project when collaborating on the same dataset or project. You’ll need to discuss whether you need your own Project, or can be added to an existing Project, with whoever is supplying the funding (most likely your PI / supervisor).</p>
<p>Either way, first make your own account using your institutional details by logging in here: <a href="https://my.nesi.org.nz/">https://my.nesi.org.nz/</a>.</p>
<p><img src="figures/reannz-01.png" class="img-fluid" style="width:100.0%"></p>
<p>From there, you can apply/access/view your Projects, and manage the <a href="https://docs.nesi.org.nz/Getting_Started/Allocations/What_is_an_allocation/">compute resource allocation</a> of the Project.</p>
<p>Once you have an account and a Project, you can start using the HPC by logging in to Open OnDemand here: <a href="ondemand.nesi.org.nz">ondemand.nesi.org.nz</a></p>
<p><img src="figures/reannz-02.png" class="img-fluid" style="width:100.0%"></p>
<p>Once logged in, you’ll see an app-based dashboard.</p>
<p>Click on ‘Jupyter Lab’ and then you can chose a few different settings before launching. For the most part, you will only need to change the Project Code and the number of hours you need the session open. You can leave the number of cores and memory per job as the default lowest settings.</p>
<p><img src="figures/reannz-04.png" class="img-fluid" style="width:100.0%"></p>
<p>Once the session is open, you can interact with your files through the directory structure on the left, and open either a Terminal or various other scripting programs through the Launcher. More on using the Terminal (also known as shell / unix shell / bash) in the next lesson.</p>
<p>For each Project, you will have a <code style="color:blue">nobackup</code> and a <code style="color:blue">project</code> directory. Keep your raw files in the <code style="color:blue">project</code> directory and do your analysis in the <code style="color:blue">nobackup</code> directory. As you can guess by the name, this directory is not backed up, and is best used for working analyses. Additionally, files not modified after 90 days are auto deleted. Final analysed files and imprortant scripts should be copied into the <code style="color:blue">project</code> directory once you have completed your analysis. You may be surprised by how many intermediate files you make and how much ‘tinkering’ you do during your analyses–making use of the two directories helps keep your file system tidier.</p>
<blockquote class="blockquote">
<p>Note: It can be a good idea to back-up raw genomic files on a HCS / reannz freezer?</p>
</blockquote>
<p><strong><em>Getting your genomic files on to the REANNZ cluster</em></strong></p>
<p>How do we actually get the genomic sequence files from the sequencing facility to the REANNZ cluster?</p>
<p><strong>FILL IN HERE</strong></p>
<p>GLOBUS</p>
<p><strong><em>Want more info?</em></strong></p>
<ul>
<li>REANNZ provide <a href="https://docs.nesi.org.nz/">extensive documentation</a> on how to use their High Performance Computing (HPC) platforms.</li>
</ul>
<blockquote class="blockquote">
<p>In July 2025, the New Zealand eScience Infrastructure (NeSI) was integrated into REANNZ. You may have heard of NeSI before, but if not, it is good to be aware of the name, as you’ll see some legacy branding in the REANNZ documentation or log-in platform (<em>e.g.,</em> my.nesi.org.nz is still in use).</p>
</blockquote>
</section>
<section id="aoraki-at-the-university-of-otago" class="level2">
<h2 class="anchored" data-anchor-id="aoraki-at-the-university-of-otago">Aoraki at the University of Otago</h2>
<p>If you are a University of Otago staff or student, you can use the “Aoraki” HPC cluster. Like REANNZ, you will also connect to the cluster through an Open OnDemand app-based interactive web page.</p>
<p>https://rtis.cspages.otago.ac.nz/research-computing/cluster/index.html</p>
</section>
<section id="other-universities-hpchcs-options" class="level2">
<h2 class="anchored" data-anchor-id="other-universities-hpchcs-options">Other universities HPC/HCS options?</h2>
<p>Auckland?</p>
</section>
<section id="ethical-data-management" class="level2">
<h2 class="anchored" data-anchor-id="ethical-data-management">Ethical data management</h2>
<section id="fair-and-care" class="level3">
<h3 class="anchored" data-anchor-id="fair-and-care">FAIR and CARE</h3>
<p>In 2016, the <a href="https://www.go-fair.org/fair-principles/">FAIR principles</a> were published in <em>Scientific Data</em>. These guidelines set to provide a standard through which to improve digital assets:</p>
<ul>
<li><strong>F</strong>indability<br>
</li>
<li><strong>A</strong>ccessibility<br>
</li>
<li><strong>I</strong>nteroperability<br>
</li>
<li><strong>R</strong>euse</li>
</ul>
<p>Part of conducting FAIR research is having a <strong>reproducible</strong> research pipeline. One way this can be done is by documenting your work on a version control system like GitHub. See our <a href="https://genomicsaotearoa.github.io/BioinformaticsTrainingProgramme/portfolio.html#reproducibility-with-git-and-quarto">GA workshop for more on Reproducibility with Git and Quarto</a>.</p>
<p>Open science advocates have embraced this FAIR framework, while others critise its lack of protection of data, for not considering the rights and interest of those that should hold governance over data, in particular, indigenous peoples. In response to this, the CARE framework has also been proposed by <a href="https://www.gida-global.org/care">Global Indigenous Data Analysis</a>, to complement the existing FAIR principles:</p>
<ul>
<li><strong>C</strong>ollective benefit<br>
</li>
<li><strong>A</strong>uthority to control<br>
</li>
<li><strong>R</strong>esponsibility<br>
</li>
<li><strong>E</strong>thics</li>
</ul>
<p><img src="figures/fair-care.png" class="img-fluid"></p>
<p>This story <a href="https://www.science.org/content/article/not-free-all-indigenous-communities-want-limits-how-their-data-are-shared">“Open with care; Indigenous researchers and communities are reshaping how Western science thinks about data ownership”</a> is an interesting read on these perspectives.</p>
<p>The Aotearoa Genomic Data Repository (AGDR) and Rakeiora platform are examples of services that have adopted these CARE principles.</p>
</section>
<section id="aotearoa-genomic-data-repository-agdr" class="level3">
<h3 class="anchored" data-anchor-id="aotearoa-genomic-data-repository-agdr">Aotearoa Genomic Data Repository (AGDR)</h3>
<p>From the <a href="https://data.agdr.org.nz/">AGDR website</a>:</p>
<p><em>“The Aotearoa Genomic Data Repository provides secure within-nation storage, management and sharing of non-human genomic data generated from biological and environmental samples originating in Aotearoa New Zealand. This resource has been developed to follow the principles of Māori Data Sovereignty, and to enable kaitiakitanga (guardianship), so that iwi, hapū and whānau (tribes, kinship groups and families) can effectively exercise their responsibilities as guardians over biological entities that are taonga (precious or treasured). While the repository is designed to facilitate the sharing of data — making it findable by researchers and interoperable with data held in other genomic repositories — the decision-making process regarding who can access the data is entirely in the hands of those holding kaitiakitanga over each data set.”</em>”</p>
<p>The AGDR is enabled by MBIE funding to Genomics Aotearoa.</p>
</section>
<section id="rakeiora-genomics-platform" class="level3">
<h3 class="anchored" data-anchor-id="rakeiora-genomics-platform">Rakeiora Genomics platform</h3>
<p>The <a href="https://rakeiora.ac.nz/">Rakeiora Genomics Platform</a> is designed to enable and test pilot precision medicine research, linking genomics and health.</p>
<p>They have chosen a <strong>walled garden</strong> approach to this infrastructure.</p>
<p><em>“This means that all genomic data and health data, and its analysis, are undertaken only within this computational environment – the data never leave and are certainly never downloaded to a researcher’s own computer or a hospital clinical laboratory computer…<br>
…Its modular nature will allow linkage (with consent) to other health data systems currently under development in Aotearoa New Zealand. This approach in particular addresses transparency of use and control over narratives. Lack of these features in other precision medicine platforms worldwide has led to significant problems for patients and research participants, including indigenous communities; learning from these negative experiences is key to avoid repeating them.”</em> – From the <a href="https://www.genomics-aotearoa.org.nz/our-work/health-projects/rakeiora-pathfinder-genomic-medicine">Genomics Aotearoa website.</a></p>
</section>
</section>
<section id="public-data" class="level2">
<h2 class="anchored" data-anchor-id="public-data">Public data</h2>
<p>You are probably familiar with using the <a href="https://www.ncbi.nlm.nih.gov/">NIH NCBI database</a>, hosted by the United States Government, for things such as BLAST searches and literature searches.</p>
<p>NCBI has a repository called the Sequence Read Archive (SRA), which is where a large proportion of genomic data from all over the world is stored, as publicly available raw, high-throughput, sequencing data.</p>
<p>If your data has no ethical concerns, this can be a great resource for making your data freely available and easily citeable in publications.</p>
<p>Here we will not go into detail on how to either download or upload data to the SRA (see <a href="https://www.ncbi.nlm.nih.gov/sra">documentation on their website</a>). But some points to be aware of are:</p>
<ul>
<li><p>A <a href="https://www.ncbi.nlm.nih.gov/bioproject/">BioProject</a> is a way to link all the sequencing and biological data together under one umbrella (as a general rule, 1 publication = 1 BioProject, but many groups use a single BioProject for multiple publications). If you are uploading your own data, we recommend starting with creating a BioProject, which will then give you a single accession (e.g., PRJNA31257) to use for the next steps (BioSample + SRA raw read uploads).</p></li>
<li><p>A <a href="https://www.ncbi.nlm.nih.gov/biosample">BioSample</a> is a unique descriptor of the biological source material (e.g, all the biological metadata of your sample – species, sex, age, location, tissue). This is often (but not strictly) set up as 1 BioSample = 1 library. Each BioSample accession will be linked to the matching sequence data in the SRA, and all housed under one BioProject accession number.</p></li>
</ul>
<p>Equally, if you are downloading data from the SRA, you can make use of BioProject and BioSample accessions to identify and orientate yourself to the data.</p>
<p>Example BioProject:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Human airway smooth muscle transcriptome study
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can see there are 16 SRA experiments and 16 BioSamples – you can guess that these probably match one to one.</p>
<p>There are also GEO datasets (Gene Expression Omnibus) associated with this study, which are repositories for functional genomic data. These are a more processed form of the data e.g., count tables and differential expression data.</p>
<p><img src="figures/bioproject-01a.png" class="img-fluid"><br>
<img src="figures/bioproject-01b.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>This is not the only public repository of sequence reads, some other examples include: <a href="https://www.ebi.ac.uk/ena/browser/home">European Nucleotide Archive (ENA)</a> and the DNA data bank of Japan <a href="https://www.ddbj.nig.ac.jp/dra/index-e.html">DDBJ Sequence Read Archive (DRA)</a>. These data banks are linked together via the <a href="https://www.insdc.org/">International Nucleotide Sequence Database Collaboration</a>. NCBI also details some of the <a href="https://www.ncbi.nlm.nih.gov/genbank/collab/">collaborative projects here</a> (e.g., The Taxonomy Project, The Feature Table).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./planning-for-submission.html" class="pagination-link" aria-label="Planning for submission">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Planning for submission</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./data-wrangling-and-processing.html" class="pagination-link" aria-label="Genomic data wrangling and processing">
        <span class="nav-page-text">Genomic data wrangling and processing</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>