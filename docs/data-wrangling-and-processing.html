<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>data-wrangling-and-processing ‚Äì Genomic Data Carpentry (Aotearoa edition)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data-storage-and-management.html" rel="prev">
<link href="./theme-images/GA-image-black-favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-709f788519238433456b39eacb8aeed0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="‚Äì Genomic Data Carpentry (Aotearoa edition)">
<meta property="og:description" content="">
<meta property="og:image" content="figures/fastq-reads.png">
<meta property="og:site_name" content="Genomic Data Carpentry (Aotearoa edition)">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-wrangling-and-processing.html">Genomic data wrangling and processing</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomic Data Carpentry (Aotearoa edition)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/GenomicsAotearoa/genomic-data-carpentry-nz" title="Github" class="quarto-navigation-tool px-1" aria-label="Github"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test-styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">_test styles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ethical-considerations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Before you begin: Ethical considerations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation-tidiness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organisation and tidy data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preparing-for-sequencing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preparing for sequencing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-storage-and-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genomic data storage and management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-wrangling-and-processing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Genomic data wrangling and processing</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#genomic-data-wrangling-and-processing" id="toc-genomic-data-wrangling-and-processing" class="nav-link active" data-scroll-target="#genomic-data-wrangling-and-processing">Genomic data wrangling and processing</a>
  <ul>
  <li><a href="#command-line-interface-cli-vs-graphical-user-interface-gui" id="toc-command-line-interface-cli-vs-graphical-user-interface-gui" class="nav-link" data-scroll-target="#command-line-interface-cli-vs-graphical-user-interface-gui">Command-line interface (CLI) vs graphical user interface (GUI)</a></li>
  <li><a href="#understanding-genomic-file-types" id="toc-understanding-genomic-file-types" class="nav-link" data-scroll-target="#understanding-genomic-file-types">Understanding genomic file types</a>
  <ul class="collapse">
  <li><a href="#ont" id="toc-ont" class="nav-link" data-scroll-target="#ont">ONT</a></li>
  <li><a href="#other-genomic-file-types" id="toc-other-genomic-file-types" class="nav-link" data-scroll-target="#other-genomic-file-types">Other genomic file types</a></li>
  </ul></li>
  <li><a href="#fastqc---quality-scoring-of-raw-reads" id="toc-fastqc---quality-scoring-of-raw-reads" class="nav-link" data-scroll-target="#fastqc---quality-scoring-of-raw-reads">FASTQC - quality scoring of raw reads</a>
  <ul class="collapse">
  <li><a href="#examples-good-vs-bad-sequence-data" id="toc-examples-good-vs-bad-sequence-data" class="nav-link" data-scroll-target="#examples-good-vs-bad-sequence-data">EXAMPLES: Good vs bad sequence data</a>
  <ul class="collapse">
  <li><a href="#per-base-sequence-quality" id="toc-per-base-sequence-quality" class="nav-link" data-scroll-target="#per-base-sequence-quality">Per base sequence quality</a></li>
  <li><a href="#per-sequence-quality-scores" id="toc-per-sequence-quality-scores" class="nav-link" data-scroll-target="#per-sequence-quality-scores">Per sequence quality scores</a></li>
  <li><a href="#overrepresented-sequences" id="toc-overrepresented-sequences" class="nav-link" data-scroll-target="#overrepresented-sequences">Overrepresented sequences</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#good-genome-bad-genome" id="toc-good-genome-bad-genome" class="nav-link" data-scroll-target="#good-genome-bad-genome">Good genome, bad genome?</a>
  <ul class="collapse">
  <li><a href="#exercises-8-mins" id="toc-exercises-8-mins" class="nav-link" data-scroll-target="#exercises-8-mins">EXERCISES üß†üèãÔ∏è‚Äç‚ôÄÔ∏è (8 mins):</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>
<div class="workshop-banner">
  WORK IN PROGRESS
</div>




<section id="genomic-data-wrangling-and-processing" class="level1">
<h1>Genomic data wrangling and processing</h1>
<p>Your data is now on a server/cloud/compute system/local computer, ready for analysis. Now what?</p>
<section id="command-line-interface-cli-vs-graphical-user-interface-gui" class="level2">
<h2 class="anchored" data-anchor-id="command-line-interface-cli-vs-graphical-user-interface-gui">Command-line interface (CLI) vs graphical user interface (GUI)</h2>
<p>Command line interface (CLI) and graphic user interface (GUI) are different ways of interacting with a computer‚Äôs operating system. They have different pros and cons. Most people are familiar with the GUI (i.e., point and click) as it is the default interface for most software, particularly on Windows and Mac OS. When using the GUI, you see and interact with visual representations of files, folders, applications, and most other functions of your computer. When using the CLI, you work largely with text representations of software, files, folders, input and output. The shell is a program that allows you to control your computer by typing instructions on the CLI with a keyboard.</p>
<p>There are several reasons to learn how to use the CLI:</p>
<ul>
<li>For most bioinformatics tools, there are no graphical interfaces. <strong>If you want to work in metagenomics or genomics, you‚Äôre going to need to use the CLI/ shell.</strong><br>
</li>
<li>The shell gives you power and allows you to work more efficiently. Tasks that are repetitive (e.g.&nbsp;renaming hundreds of files) can be automated. Tasks that are tedious (e.g.&nbsp;testing a range of input parameters) can be simplified.<br>
</li>
<li>To use remote computers or cloud computing, you often need to use the shell.</li>
</ul>
<p>Here we will not show you how to use the CLI; we recommend checking out our workshops on <a href="https://genomicsaotearoa.github.io/BioinformaticsTrainingProgramme/portfolio.html#introduction-to-shell-for-bioinformatics">Introduction to Shell</a> and <a href="https://genomicsaotearoa.github.io/BioinformaticsTrainingProgramme/portfolio.html#intermediate-shell-for-bioinformatics">Intermediate Shell</a>.</p>
<blockquote class="blockquote">
<p>Note: you‚Äôll hear the terms ‚Äòshell‚Äô, ‚Äòbash‚Äô, ‚Äòunix‚Äô, ‚Äòterminal‚Äô and ‚Äòcommand-line‚Äô used almost interchangeably. For beginners, you can think of them as essentially all the same thing! As you gain more computational skills, you can dig into the differences.</p>
</blockquote>
</section>
<section id="understanding-genomic-file-types" class="level2">
<h2 class="anchored" data-anchor-id="understanding-genomic-file-types">Understanding genomic file types</h2>
<p>The files you will get back from the sequencing facility will most likely end in <code>.fastq.gz</code></p>
<p>The <code>.gz</code> indicates it is a compressed gzip file. For most genomic analyses, you do not need to unzip these first‚Äìthis saves you storage space, as unzipped files can be double or triple the zipped size! Your zipped sequence read files will likely be around 1-10 GB per file.</p>
<p>The <code>fastq</code> indicates the file is in <a href="https://en.wikipedia.org/wiki/FASTQ_format">FASTQ format</a>. FASTQ files are a text-based format that stores the raw read sequences, along with a quality score for each base.</p>
<p>The first 4 lines of a fastq file describe one sequence read:</p>
<p><img src="figures/fastq-reads.png" class="img-fluid"></p>
<p>The <strong>first line is the header information</strong>, beginning always with an <code style="color:black">@</code>. This is the instrument-specific, run identifier and read identifiying information.</p>
<ul>
<li><code style="color:black">V350304715</code> = instrument-specific<br>
</li>
<li><code style="color:black">L3</code> = lane 3 on the flow cell. Can be used for troubleshooting if something globally went wrong with sequencing.<br>
</li>
<li><code style="color:black">C001</code> = cluster identifier (can be used for troubleshooting, same as above).<br>
</li>
<li><code style="color:black">R001</code> = Read 1. All the reads in this file are read 1. If you have paired-end data, you‚Äôll have a corresponding read 2 file.<br>
</li>
<li><code style="color:black">00020454</code> = unique identifier for that read.</li>
<li><code style="color:black">/1</code> = indicates this is a pair member. Only paired-end data have the <code style="color:black">/1</code> or <code style="color:black">/2</code> additional identifier.</li>
</ul>
<p>Each instrument and chemistry will have slightly different header information. The main thing to look out for are indications of the data being read 1 or read 2 (indicates antisense or sense strand data, for protocols that can differentiate strandedness) and whether it is part of a mate pair (indicated by the <code style="color:black">/1</code> or <code style="color:black">/2</code>)</p>
<p>The <strong>second line is the actual sequence</strong>. Count the number of bases ‚Äì which read length was chosen for this dataset? (It‚Äôs ok you don‚Äôt have to count - it‚Äôs 100)</p>
<p>The <strong>third line is just a ‚Äú+‚Äù</strong>. This can be optionally followed by the same sequence identifier (and any description) again.</p>
<p>The <strong>fourth line is the quality score</strong>. Each base in line 2 has a corresponding quality score, indicated by an ASCII character in line 4.</p>
<p>From left to right, these are the quality scores in increasing order of quality:</p>
<pre><code>!"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~</code></pre>
<p>So, if a single base has a quality score of <code style="color:black">!</code>, which corresponds to a Q-score of 0, this indicates exceptionally poor quality. The sequencing machine was not able to resolve which base it should be. Often these will be shown as N‚Äôs.</p>
<p>Conversely, if a single base has a quality score of <code style="color:black">I</code>, which corresponds to a Q-score of 40, this indicates very high quality. The sequencing machine was ‚Äúvery confident‚Äù that the base called is correct (Q40 indicates an error probabilty of 0.0001, i.e., a 1 in 10,000 chance of the base being called wrong, on average. <code style="color:black">I</code> is near the upper end of typically achieved quality values, but higher is possible.</p>
<p>For more on quality scores, you can also read this <a href="https://help.basespace.illumina.com/files-used-by-basespace/quality-scores">Illumina guide here</a>. Note there are different types of encoding, but you will most frequently encounter <a href="https://en.wikipedia.org/wiki/Phred_quality_score">Phred</a>+33.</p>
<p>We can assess the quality score across all reads using software called <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a>, and trim down reads to remove poorer quality bases below a set threshold (generally with newer sequence data, you can use Q30 or Q40 as a cut-off). We won‚Äôt cover trimming here, see our workshop on <a href="https://genomicsaotearoa.github.io/BioinformaticsTrainingProgramme/portfolio.html#rna-seq-data-analysis">RNA-seq Data Analysis</a> for a step-by-step guide.</p>
<section id="ont" class="level4">
<h4 class="anchored" data-anchor-id="ont">ONT</h4>
<p>Nanopore sequencing works quite differently to Illumina and PacBio. The default read output is POD5 and this is converted to unaligned bam.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
FILL OUT
</div>
</div>
<div class="callout-body-container callout-body">
<p>How are most seq facilities sending these reads to people?</p>
<p>ONT is pod5 -&gt; bam (unaligned)</p>
</div>
</div>
</section>
<section id="other-genomic-file-types" class="level3">
<h3 class="anchored" data-anchor-id="other-genomic-file-types">Other genomic file types</h3>
<p>We‚Äôve talked about <code>fastq</code> and <code>gz</code> files types, but there are some other common genomic file types you should know about.</p>
<p>You should also be aware that the extension on the file type is largely there just so you as a human know what kind of file it is. When using the CLI, the computer does not care what the extension says.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;">Extension</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>.fasta</code> or <code>.fa</code>, <code>.fna</code>, <code>.faa</code></td>
<td>FASTA, FASTA nucleic acid, FASTA amino acid</td>
<td>Contains sequence data. Each sequence starts with a single header line starting with a <code style="color:black">&gt;</code>, followed by the nucleotide (or amino acid in case of <code>.faa</code>) sequence on the second line. No quality encoding included.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>.bam</code> <code>.sam</code></td>
<td><strong>B</strong>inary/<strong>S</strong>equence Alignment Map</td>
<td>Contains alignment information of your reads/sequences that are mapped against a reference sequence (e.g., genome). BAM are the compressed, computer-readable only version; SAM are human-readable but larger files. Somewhat interchangeable file types. Note for ONT files, the bam file is often used in an un-aligned format. You may also encounter <code>.cram</code> files, which are <strong>C</strong>ompressed <strong>R</strong>eference-oriented <strong>A</strong>lignment <strong>M</strong>ap designed to be an efficient reference-based alternative to bam/sam</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>.vcf</code></td>
<td>Variant Call Format</td>
<td>Contains sequence variants called relative to a reference genome. Split into two sections; the header information and the records. See our <a href="https://genomicsaotearoa.github.io/Introduction-to-R/02-data-prelude/#how-variant-calls-are-stored-in-vcf-files">Intro R workshop, section on VCF files</a>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>.gtf</code> or <code>.gff</code></td>
<td>General Transfer Format or General Feature Format</td>
<td>Contains genome annotation data.</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<p><strong>Real examples:</strong></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
FASTA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>FASTA file containing cds data from a genome, opened in a text editor. Each sequence is preceded by one header line, beginning with an ‚Äò&gt;‚Äô symbol. <img src="figures/fasta-file.png" class="img-fluid"></p>
<p><br>
</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
If we did not already know this fasta file contains cds data, what gives it away?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The sequence starts with a start codon ‚ÄòATG‚Äô and ends with a stop codon ‚ÄòTAA‚Äô. Also, ‚Äúcds‚Äù can be seen in the header lines as part of the sequence accession identification.</p>
</div>
</div>
</div>
<p><br>
</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
BAM/SAM
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://en.wikipedia.org/wiki/SAM_(file_format)">SAM file</a>, opened in a text editor. Note all lines in the header section starts with an ‚Äò@‚Äô symbol, and the number of lines in the header section is variable. There are 11 mandatory fields in the alignment section (not all visible here as they run off the window to the right). <img src="figures/sam-file.png" class="img-fluid"></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
VCF
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>VCF file opened in excel. Instead of the header sections seen in the other file types, here each column has a name. (not all columns visible as they run off the window to the right) <img src="figures/vcf-file.png" class="img-fluid"></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
GTF
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>GTF file opened in a text editor. Note all lines in the header section start with a ‚Äò#‚Äô symbol. Generally each GTF file you encounter will all have 4 or 5 lines in the header section, but the alignment section will vary in size based on number of annotations.<br>
<img src="figures/gtf-file.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
</section>
<section id="fastqc---quality-scoring-of-raw-reads" class="level2">
<h2 class="anchored" data-anchor-id="fastqc---quality-scoring-of-raw-reads">FASTQC - quality scoring of raw reads</h2>
<p>All <code>fastq</code> files, regardless of which kind of sequencing was performed, should be interrogated using a program called <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a>. Most HPC services (e.g., REANNZ) come with this program (and many other commonly used programs) pre-installed, so you likely will not need to install it anywhere.</p>
<p>Two of our genomic analysis workshops (<a href="https://genomicsaotearoa.github.io/BioinformaticsTrainingProgramme/portfolio.html#rna-seq-data-analysis">RNA-Seq Data Analysis</a> and <a href="https://genomicsaotearoa.github.io/BioinformaticsTrainingProgramme/portfolio.html#microbial-genome-assembly-with-short-reads">Microbial genome assembly</a>) teach you how to run fastqc on your files. Here, we will give you an introduction to what it is and how to interpret the results.</p>
<p>FastQC will give you a good overview of the quality of the reads (i.e., how confidently each base was called by the sequencing platform) and a few other statistics about the reads. Each statistic will be assigned a PASS, WARNING or FAIL:</p>
<p><img src="figures/fastqc-pass.png" class="img-fluid" style="width:8.0%"> PASS &nbsp;&nbsp;&nbsp; <img src="figures/fastqc-warn.png" class="img-fluid" style="width:8.0%"> WARNING &nbsp;&nbsp;&nbsp; <img src="figures/fastqc-fail.png" class="img-fluid" style="width:8.0%"> FAIL</p>
<p>The following examples come from the ‚Äò<a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/good_sequence_short_fastqc.html">Good Illumina Data</a>‚Äô and ‚Äò<a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/bad_sequence_fastqc.html">Bad Illumina Data</a>‚Äô reports from the <a href="https://www.bioinformatics.babraham.ac.uk/index.html">Babraham Bioinformatics website</a>.</p>
<blockquote class="blockquote">
<p>Caveat: FastQC can be run on any <code>.fastq</code> data, but the pass, warning, fail metrics are based on Illumina data. ONT data in particular may receive fails, even when it is perfectly usable.</p>
</blockquote>
<section id="examples-good-vs-bad-sequence-data" class="level3">
<h3 class="anchored" data-anchor-id="examples-good-vs-bad-sequence-data">EXAMPLES: Good vs bad sequence data</h3>
<p>Below are the summarised pass, warning, fail statistics for the good (left) and bad (right) data. <img src="figures/fastqc-good-bad-summary.png" class="img-fluid" style="width:80.0%"></p>
<p>Here we will choose a few of these statistics as examples to delve into:</p>
<section id="per-base-sequence-quality" class="level4">
<h4 class="anchored" data-anchor-id="per-base-sequence-quality">Per base sequence quality</h4>
<p>The <strong>per base sequence quality</strong> is the first plot you can use to assess the quality. You can picture the reads as being all stacked on top of each other, and the average quality at each position (x-axis) shown as a boxplot (i.e., position 1 shows a boxplot of the quality scores of base pair #1 in all reads, position 2 shows a boxplot for base pair #2, and so on).</p>
<p>The quality score is shown on the y-axis. A score of below Q20 (error probabilty = 0.01, or 1 in 100 bases are incorrect on average) is shown as red - boxplots that extend in to this section indicate positions in the read that are poor quality.</p>
<p>In general, when you are trimming your reads you should pick a quality cut off of at least Q30 (error probabilty = 0.001; 1 in 1000), and some researchers even use Q40 (error probabilty = 0.0001; 1 in 10,000) for newer data. If you are working with older data (10+ years old, sequenced before ~2014), you may need to pick Q20 as a cut-off. These plots help you decide what is best for your data.</p>
<p>After trimming reads, you should run FastQC again to compare how the average quality has changed and see how many reads are retained after trimming.</p>
<p>In this ‚Äògood data‚Äô below, all boxplots sit easily in the green range. These reads are excellent quality (i.e., the sequencing itself worked very well).</p>
<p><strong>Good data:</strong> Per base sequence quality <img src="figures/fastqc-good-01.png" class="img-fluid"></p>
<p>In this ‚ÄòBad data‚Äô below, we can see most reads are dropping in to the Q20 and below range from about base position 24 onwards to position 40. This is a typical pattern, where sequence quality tends to drop off around the 3‚Äô end for Illumina reads (even for good data ‚Äì and typically for paired end data, the 3‚Äô end of read 2 tends to be slightly poorer quality than read 1).</p>
<p><strong>Bad data:</strong> Per base sequence quality <img src="figures/fastqc-bad-01.png" class="img-fluid"></p>
</section>
<section id="per-sequence-quality-scores" class="level4">
<h4 class="anchored" data-anchor-id="per-sequence-quality-scores">Per sequence quality scores</h4>
<p>The <strong>per sequence quality scores</strong> plots the Q-score per sequence, rather than per base position as we saw above. The average Q-score for the whole read is taken, then plotted to show how many reads have that average score. Below we can see that for the good data and bad data, almost all reads sit above Q30.</p>
<p><strong>Good data:</strong> Per sequence quality scores <img src="figures/fastqc-good-02.png" class="img-fluid"></p>
<p>For the bad data, we can see that the larger peak of reads sits at a slightly lower (and wider) Q score, and there is a second peak at a very poor score of around Q17. These data show us that there may be a large proportion of reads with a high Q-score retained after trimming (good news!). The data has been given a ‚Äòpass‚Äô by FastQC, indicating it has not dropped below the threshold for this category to be given a warning or fail.</p>
<p><strong>Bad data:</strong> Per sequence quality scores <img src="figures/fastqc-bad-02.png" class="img-fluid"></p>
</section>
<section id="overrepresented-sequences" class="level4">
<h4 class="anchored" data-anchor-id="overrepresented-sequences">Overrepresented sequences</h4>
<p>Multiple sources can cause overrepresented sequences in your dataset. It can be a true biological or experimental effect, for example if you expect a few genes to be exceptionally highly expressed or if you have done targeted amplicon sequencing. However, it often reflects an issue that may have happened during extraction or library prep. Contaminating rRNA is a common culprit in RNAseq, as rRNA exists at a much higher concentration than other mRNAs in the cell. You may have to make a judgement call whether your data is still useable if it is highly contaminated. While contaminating reads can be filtered out, you‚Äôll have less useable reads. PCR overamplification during the library prep can also cause overrepresentation - in which case it may be possible to repeat part of the library prep with less PCR cycles.</p>
<p>For our good data, no overrepresented sequences were detected:</p>
<p><img src="figures/fastqc-good-03.png" class="img-fluid"></p>
<p>Here is a snippet of our bad data, showing a ‚Äòwarning‚Äô with multiple overrepresented sequences detected, and the count and percentage of the total reads is also shown:</p>
<p><img src="figures/fastqc-bad-03.png" class="img-fluid"></p>
<p>FastQC looks for hits that are matches in a database of common contaminants. No hit was detected for any of these sequences, but it is worth BLASTing some of the highest count sequences to find the culprit.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
EXERCISE üß†üèãÔ∏è‚Äç‚ôÄÔ∏è (1 min)
</div>
</div>
<div class="callout-body-container callout-body">
<p>What percentage of reads would need to be overrepresented for this category to be given a fail?</p>
<p>Use the <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/">FastQC help guide here</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
SOLUTION
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If any sequence is found to represent more than 1% of the total it will get a fail.</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="good-genome-bad-genome" class="level2">
<h2 class="anchored" data-anchor-id="good-genome-bad-genome">Good genome, bad genome?</h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
THOUGHTS
</div>
</div>
<div class="callout-body-container callout-body">
<p>This section sits out a little odd here, but I think its needed in the workshop. To me its sort of ‚Äòwrangling your brain‚Äô around genomes</p>
</div>
</div>
<p>You will often hear geneticists refer (somewhat colloquially) to <em>‚Äúgood‚Äù</em> and <em>‚Äúbad‚Äù</em> genome assemblies. But what does this actually mean? And how can you tell whether a species you are working on has a good genome assembly?</p>
<p>In practice, we assess genome assemblies using a few metrics that capture the three C‚Äôs: <strong>contiguity</strong>, <strong>correctness</strong>, and <strong>completeness</strong>.</p>
<p>In our <a href="https://genomicsaotearoa.github.io/long-read-assembly-one-day/pages/4_assembly_qc/">Long read genome assembly</a> workshop, we go into further detail on how to assess these metrics. For now, we‚Äôll focus on an overview to get you started:</p>
<p><strong><em>Common genome assembly metrics</em></strong></p>
<ul>
<li><p><strong>Contiguity</strong> describes how complete or fragmented the genome assembly is. Because we can‚Äôt sequence an entire chromosome in one long piece, the genome is first broken into many smaller fragments during library prep and sequencing. The more pieces we can put together (i.e., assemble) to make longer strings of sequence, the more <em>contiguous</em> our assembly is. Contiguity is commonly summarised using contig N50 and scaffold N50. The N50 is a length statistic and you can think of it as similar to the median. The N50 value is the length of the first contig that is equal to or greater than half of the assembly sum. In simple terms, the larger than better. A larger N50 means that more of the genome is contained in longer sequences. In this era of long-read genome assemblies, a contig N50 over 1 Mb is generally considered good - see <a href="https://www.pacb.com/blog/beyond-contiguity/">Excerpt from PacBio article.</a></p></li>
<li><p><strong>Completeness</strong> can be measured in multiple ways, but it is often measured using a BUSCO (<strong>B</strong>enchmarking <strong>U</strong>niversal <strong>S</strong>ingle-<strong>C</strong>opy <strong>O</strong>rthologs) score. This measures completeness using sets of conserved, single-copy genes expected to be present in most species within a specified lineage, which are reported as percentages of complete, duplicated, fragmented, and missing genes, to a total of 100%. Essentially, we check to see if a bunch of genes we expect to see in every species are present in our assembly.</p></li>
<li><p><strong>Correctness</strong> describes the base pair and structural accuracy of the genome. It can be measured by comparing your assembly to a reference genome. There are a few limitations to this approach, namely that if a good reference genome for your species does not exist you will have to use a different approach (for which there are solutions - see our long read genome assembly workshop link above).</p></li>
</ul>
<p>Genome assemblies can be described more qualitatively as (in order of least to most complete):</p>
<ol type="1">
<li><strong>Contig-level</strong> ‚Äì sequences are assembled but not ordered or oriented. Often can be thousands to hundreds of thousands of contigs.<br>
</li>
<li><strong>Scaffold-level</strong> ‚Äì contigs linked together, often with gaps. None are placed (i.e., chromosome known) or localised (i.e., orientation on chromosome known).<br>
</li>
<li><strong>Chromosome-level</strong> ‚Äì one or more chromosomes complete, but some unplaced scaffolds may be present.<br>
</li>
<li><strong>Complete genome</strong> ‚Äì all chromosomes are resolved with no gaps. Not necessarily telomere-to-telomere (T2T). Very rare to have a complete genome assembly.</li>
</ol>
<p>See <a href="https://www.ncbi.nlm.nih.gov/datasets/docs/v2/glossary/">NCBI Glossary for Assembly level</a>.</p>
<p><br>
</p>
<p><strong><em>What do we mean by a ‚Äúgood‚Äù genome?</em></strong></p>
<p>A <em>good</em> genome assembly is typically one that is:</p>
<ul>
<li><p><strong>Highly contiguous</strong><br>
Reads have been assembled into long sequences called <em>contigs</em>, ideally approaching full chromosome lengths.</p></li>
<li><p><strong>Biologically complete</strong><br>
Most expected genes are present (high BUSCO completeness).</p></li>
<li><p><strong>Structurally accurate</strong><br>
Large-scale errors such as mis-joins or collapsed repeats are minimised.</p></li>
</ul>
<blockquote class="blockquote">
<p>Note: often the word ‚Äòcontig‚Äô is used to refer to any length of assembled (i.e., contiguous) sequence, regardless of if those sequences could technically be long enough to be called scaffolds or chromosomes.</p>
</blockquote>
<p><br>
</p>
<p><strong><em>Assembly quality vs annotation quality</em></strong></p>
<p>Lastly, it is important to distinguish between:</p>
<p><strong>Genome assembly</strong> i.e., the reconstructed DNA sequence itself, and the <strong>Genome annotation</strong>, which is the identification and labelling of genomic features, including gene structures (exons, introns, and CDS), non-coding RNAs (e.g., rRNA, tRNA and lncRNA), and associated identifiers such as gene_id, transcript_id, and database cross-references.</p>
<p>A genome can be <strong>well assembled but poorly annotated</strong>, or vice versa.</p>
<blockquote class="blockquote">
<p>Watch out! It can be tempting based on the BUSCO score to conclude that the ‚Äúannotations‚Äù for a genome are quite good (or bad). The BUSCO score IS NOT the genome annotation; it is an independent analysis of a set of known genes. The annotation file itself (scroll up to section <a href="#understanding-genomic-file-types">Understanding genomic file types</a> for description of annotation files such as GTF files) is not being assessed when we look at the BUSCO score.</p>
</blockquote>
<p><br>
</p>
<section id="exercises-8-mins" class="level3">
<h3 class="anchored" data-anchor-id="exercises-8-mins">EXERCISES üß†üèãÔ∏è‚Äç‚ôÄÔ∏è (8 mins):</h3>
<p><strong><em>How would you describe these genomes?</em></strong></p>
<p>Look at the assembly stats and evaluate how ‚Äògood‚Äô you think each assembly is.</p>
<p>Note: RefSeq is the curated database. GenBank is the non-curated, anyone-can-submit-to database. They can be different, but not always. Use the RefSeq stats to make your decision.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
EXERCISE #1 üß†üèãÔ∏è‚Äç‚ôÄÔ∏è (4 mins) - Human Genome Assembly
</div>
</div>
<div class="callout-body-container callout-body">
<p>Link here to <a href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_000001405.40/">Human Genome assembly GRCh38.p14</a></p>
<p><img src="figures/genome-assembly-human-01.png" class="img-fluid"></p>
<p><img src="figures/genome-assembly-human-02.png" class="img-fluid"></p>
<p>Jot down your thoughts before looking at the solution below.</p>
<p>Here are some points to help you:</p>
<ul>
<li>What is the assembly level and where does that fall on our scale level of contig -&gt; scaffold -&gt; chromosome -&gt; complete?<br>
</li>
<li>How many chromosomes, if any, are resolved? (Hint: if there are any resolved it is a good assembly!)</li>
<li>What is the scaffold N50? Is it above 1Mb? (typically considered a fairly good assembly if &gt;1 Mb).</li>
<li>What is the BUSCO score? Is it approaching 100% complete?</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Human genome solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The assembly is at Chromosome level - indicates very high quality.</li>
<li>The BUSCO score is 98.9% - very close to complete.<br>
</li>
<li>The number of scaffolds (470) and contigs (996) are very low at less than a thousand each, indicating the majority of sequences are assembled into the chromosomes. Further, the scaffold and contig N50s are very high, well over 1 Mb, indicating further that the majority of these sequences are very long contiguous sequences.</li>
</ul>
<p>Conclusion: this is a very good genome assembly.</p>
</div>
</div>
</div>
</div>
</div>
<p><br>
</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
EXERCISE #2 üß†üèãÔ∏è‚Äç‚ôÄÔ∏è (4 mins) - Sea Anemone Genome Assembly
</div>
</div>
<div class="callout-body-container callout-body">
<p>Link here to <a href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_000209225.1/"><em>Nematostella vectensis</em> (sea anemone) Genome assembly ASM20922v1</a></p>
<p><img src="figures/genome-assembly-nemvec-01.png" class="img-fluid"></p>
<p><img src="figures/genome-assembly-nemvec-02.png" class="img-fluid"></p>
<p>Jot down your thoughts before looking at the solution below.</p>
<p>Here are some points to help you:</p>
<ul>
<li>What is the assembly level and where does that fall on our scale level of contig -&gt; scaffold -&gt; chromosome -&gt; complete?<br>
</li>
<li>How many chromosomes, if any, are resolved? (Hint: if there are any resolved it is a good assembly!)</li>
<li>What is the scaffold N50? Is it above 1Mb? (typically considered a fairly good assembly if &gt;1 Mb).</li>
<li>What is the BUSCO score? Is it approaching 100% complete?</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sea anemone solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The assembly is at scaffold level; no chromosomes are resolved - this is a ‚Äúmedium‚Äù quality genome.</li>
<li>The scaffold N50 is &lt;1 Mb; at 472.6 kb - indicating again the quality is ‚Äúmedium‚Äù or ‚Äúaverage‚Äù.</li>
<li>The BUSCO score is pretty good at 97.7% single copy orthologs resolved - this indicates that the scaffolds resolved are likely long enough and correct enough to resolve the majority of genes. Functionally, this is quite a useable genome at a gene level.</li>
</ul>
<p>Conclusion: this is a medium or average assembly. Larger scale structural variants may be difficult or erroneous to resolve, but gene level comparisons and analyses could be achieved fairly accurately.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Extra for experts
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here is the original paper for the curious: <a href="https://www.science.org/doi/10.1126/science.1139158">Putnam et al.&nbsp;2007.</a></p>
<p>The authors claim the genome reveals <em>‚Äúancestral eumetazoan genomic organization‚Äù</em>. How did they assess this and what conclusion did they make about the eumetazoan ancestor resemblance to modern vertebrates, sea anemones and protosomes? Do you think they had a ‚Äògood‚Äô enough genome to assess this?</p>
<div class="callout callout-style-simple callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Extra for experts solution
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>NEED TO FACT CHECK THIS, COLLAPSE WHEN COMPLETE</strong></p>
<p>The authors used synteny analysis. They found many major genes, such as Hox genes, retained the same intron/exon structure in sea anemones as vertebrates, but this was not retained in model protosome species. Based on this they concluded that sea anemone genomes more closely resemble vertebrates than protosome species (fly, nematode, annelid) do. While the genome assembly itself is somewhat fragmented, the BUSCO score was quite good, indicating that any conclusions the authors made comparing genomes and a gene stucture level are likely quite robust, but it would not be feasible with this assembly to make any conclusions based on larger genomic structure (i.e., at closer to chromosome level).</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br>
</p>
</div>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>close off with a quick summary of what the workshop has covered,</p>
<p>a bullet point list of other GA workshops (with links) and a one sentence description of what is covered.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./data-storage-and-management.html" class="pagination-link" aria-label="Genomic data storage and management">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Genomic data storage and management</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>